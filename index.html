<!DOCTYPE html>
<html lang="ht">
<head>
    <script src="https://unpkg.com/hammerjs@2.0.8/hammer.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google" content="notranslate" />
    <title>Akèy - Les Cayes Dropshipping</title>
    
    <link rel="stylesheet" href="base.css"> 
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"> 

    <link rel="manifest" href="/manifest.json">
    
    <meta name="apple-mobile-web-app-title" content="LCDrop">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="/lescayesdropshipping.png">
    <style>
        /* ================= styles spécifiques et améliorés ================= */
        
        :root {
            --bleu-marin: #001f3f; 
            --kaki: #8fbc8f;              
            --gri-clair: #f0f0f0;         
            --noir-texte: #333;           
            --blanc-fond: #ffffff;        
            --rouge-alerte: #e74c3c; 
            --vert-menu: #004D40; 
        }
        
        body {
            font-family: Arial, sans-serif;
            background-color: var(--gri-clair);
            color: var(--noir-texte);
            margin: 0;
            padding-bottom: 70px; 
        }

        /* Titres */
        .section-title {
            font-size: 1.6em;
            margin: 25px 0 15px 0;
            font-weight: 900; 
            color: var(--bleu-marin);
            text-align: left;
            padding-left: 5px;
            border-left: 5px solid var(--kaki); 
            
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* NOUVEAU: En-tête de localisation (MODIFIÉ) */
        #location-header {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 5px;
            padding: 10px 15px;
            background-color: var(--blanc-fond); 
            color: var(--bleu-marin);
            font-weight: bold;
            font-size: 0.9em;
        }
        #location-header .location-icon {
            color: var(--kaki); 
        }
        .dropdown-icon {
            color: var(--bleu-marin);
        }
        
/* Seksyon Enfòmasyon Livrezon */
#info-livrezon-container {
    text-align: left;
    background: linear-gradient(135deg, #40E0D0, #FFFF00); 
    color: var(--bleu-marin); 
    padding: 20px 15px; 
    border-radius: 12px;
    margin: 15px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); 
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.info-step {
    border-bottom: 1px solid rgba(0, 31, 63, 0.1);
    padding-bottom: 12px;
}

.info-step.no-border {
    border-bottom: none;
    padding-bottom: 0;
}

.info-title {
    margin: 0;
    font-size: 0.9em;
    font-weight: bold;
    text-transform: uppercase;
    opacity: 0.8;
}

.info-detail {
    color: #FF0000; /* Kenbe koulè wouj la pou dat ak jou yo ka parèt byen */
    font-size: 1.3em;
    font-weight: 900;
    margin: 5px 0;
}

.info-sub {
    margin: 0;
    font-size: 0.75em;
    line-height: 1.4;
    color: var(--bleu-marin);
    font-weight: normal;
}

.announcement-bar {
    background-color: var(--bleu-marin);
    color: var(--blanc-fond);
    overflow: hidden; /* Sa kache tèks la lè l soti deyò */
    white-space: nowrap;
    padding: 8px 0;
    font-size: 0.85em;
    font-weight: 500;
    position: relative;
    border-bottom: 1px solid rgba(255,255,255,0.1);
}

.scrolling-text {
    display: inline-block;
    padding-left: 100%; /* Kòmanse tèks la nèt sou bò dwat */
    animation: scroll-announcement 20s linear infinite;
}

@keyframes scroll-announcement {
    0% {
        transform: translateX(0);
    }
    100% {
        transform: translateX(-100%);
    }
}

/* Si ou vle animasyon an rete lè sourit la sou li */
.announcement-bar:hover .scrolling-text {
    animation-play-state: paused;
}

        /* Kourousèl */
        #banner-carousel {
            overflow-x: scroll; 
            height: 120px; 
            position: relative;
            margin: 20px 0;
            padding: 0 0 0 15px; 
            scroll-snap-type: x mandatory; 
            -webkit-overflow-scrolling: touch; 
            scrollbar-width: none; 
        }

        #banner-carousel::-webkit-scrollbar {
            display: none;
        }
        
        .carousel-container {
            height: 100%;
            display: flex;
        }
        
        .carousel-item {
            min-width: calc(100vw - 30px); 
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--blanc-fond);
            text-align: center;
            padding: 15px 25px; 
            position: relative;
            border-radius: 15px; 
            margin-right: 15px; 
            flex-shrink: 0;
            scroll-snap-align: start; 
        }
        
        .carousel-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.55); 
            z-index: 1;
        }
        
        /* AJUSTEMENTS BANNER TEXT */
        .banner-text {
            position: relative;
            z-index: 2; 
            text-align: center; 
            width: 100%; 
        }

        .banner-text h1 {
            font-size: 1.1em; 
            text-shadow: 1px 1px 3px #000; 
            margin: 0;
            font-weight: 900; 
            text-transform: uppercase; 
        }
        .banner-text p {
            font-size: 0.75em; 
            margin-top: 5px;
            text-shadow: 1px 1px 2px #000;
        }
        
        /* Cartes produits */
        #deal-products {
            display: flex;
            overflow-x: scroll; 
            gap: 15px;
            padding: 10px 15px 10px 0; 
            scroll-snap-type: x mandatory; 
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }

        #deal-products::-webkit-scrollbar {
            display: none;
        }

        #deal-products .product-card-link {
             scroll-snap-align: start; 
             text-decoration: none; 
             color: inherit; 
        }
        
        #deal-products .product-card-link:first-child {
            margin-left: 15px;
        }

        #main-content {
            padding: 0 15px; 
        }

        .product-card {
            min-width: 160px;
            background-color: var(--blanc-fond); 
            border-radius: 12px; 
            padding: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); 
            transition: transform 0.2s;
            text-align: center;
        }
        
        .product-card img {
            width: 100%;
            height: 100px; 
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 5px;
        }

        .price {
            font-weight: bold;
            font-size: 1.1em;
            color: var(--bleu-marin);
            margin: 5px 0;
        }

        .stock {
            font-size: 0.8em;
            margin-bottom: 5px;
            color: var(--kaki); 
            font-weight: 600;
        }

        .btn-ajouter {
            background-color: var(--kaki); 
            color: var(--bleu-marin); 
            border: 2px solid var(--bleu-marin); 
            padding: 8px 15px;
            border-radius: 20px; 
            cursor: pointer;
            width: 100%;
            font-weight: bold;
            margin-top: 10px;
            transition: background-color 0.3s;
            display: flex; 
            align-items: center;
            justify-content: center;
        }

        /* Style de l'icône dans le bouton "Mete nan panye" */
        .btn-ajouter .material-icons {
            font-size: 18px;
            margin-right: 5px;
            color: var(--bleu-marin); 
        }
        
        #main-content > p {
            background-color: var(--gri-clair); 
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .material-icons {
            font-family: 'Material Icons';
        }
        
        /* Footer Styles */
        #main-footer {
            display: flex;
            justify-content: space-around;
            align-items: center;
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 60px;
            background-color: var(--blanc-fond); 
            box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
            z-index: 1000;
        }

        .nav-item {
            text-align: center;
            text-decoration: none;
            color: var(--vert-menu); 
            font-size: 0.75em;
            padding: 5px;
            position: relative; 
        }
        
        #main-footer .material-icons {
            color: var(--vert-menu); 
            font-size: 24px;
        }
        
        .nav-item.active .material-icons {
            color: var(--kaki); 
        }
.arrow-circle {
    display: flex;
    align-items: center;
    justify-content: center;
    /* Yon bèl koulè jòn zoranj ki vif */
    background-color: var(--kaki); 
    color: var(--bleu-marin);      /* Flèch la ap an ble marin pou l ka parèt byen */
    width: 35px;
    height: 35px;
    border-radius: 50%;
    text-decoration: none;
    transition: transform 0.2s, background-color 0.2s;
    box-shadow: 0 2px 5px rgba(255, 165, 0, 0.4); 
    margin-right: 10px;
}

.arrow-circle:hover {
    transform: scale(1.1);
    /* Lè moun pase sou li, li vin yon ti jan pi fonse */
    background-color: #FF8C00; 
}

.arrow-circle .material-icons {
    font-size: 20px;
    font-weight: bold;
}


.arrow-circle:hover {
    transform: scale(1.1);         /* Li gwosi yon ti kras lè ou pase sou li */
    background-color: var(--bleu-marin);
    color: var(--blanc-fond);      /* Koulè yo Envèse lè ou pase sou li */
}

.arrow-circle .material-icons {
    font-size: 20px;               /* Dimansyon flèch la */
    font-weight: bold;
}

        /* Style du Badge de Notification (pour Deal) */
        .cart-badge-nav {
            position: absolute;
            top: 0;
            right: 10px; 
            background-color: var(--rouge-alerte);
            color: var(--blanc-fond);
            border-radius: 50%;
            padding: 2px 5px;
            font-size: 0.65em;
            font-weight: bold;
            min-width: 10px;
            text-align: center;
            line-height: 1;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
            display: none; 
        }
/* style des boutons de profil */
    /* style pou lis ak chèk ✔️ */
.custom-list {
    list-style: none; /* retire pwen nwa yo */
    padding-left: 0;
}

.custom-list li {
    position: relative;
    padding-left: 35px; /* espas pou ti wonn nan */
    margin-bottom: 12px;
    line-height: 1.5;
}

.custom-list li::before {
    content: "✔️";
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    background-color: #fff; /* fon blan pou anndan wonn nan */
    border: 2px solid #00ced1; /* koulè ble turquoise pou wonn nan */
    border-radius: 50%; /* fè li fòme yon wonn */
    width: 22px;
    height: 22px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
}

/* ou ka aplike menm klas la pou dezyèm modal la tou */

.choix-profil { text-align: center; padding: 40px 20px; }
.container-boutons { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; margin-top: 20px; }
.btn-choix { 
    background: #FFFFF0; border: 2px solid var(--kaki); padding: 20px; border-radius: 10px; cursor: pointer;
    transition: 0.3s; width: 280px; display: flex; flex-direction: column;
}
.btn-choix:hover { background: #00ced1; color: white; }
.btn-choix span { font-size: 0.85em; margin-top: 5px; opacity: 0.8; }

/* style des fenêtres (modals) */
.modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); }
.modal-content { 
    background-color: #fff; margin: 5% auto; padding: 25px; border-radius: 15px; width: 80%; max-width: 500px;
    position: relative; max-height: 80vh; display: flex; flex-direction: column;
}

/* style du titre en jaune foncé/orange et majuscule */
.modal-title {
    color: #ff8c00; /* Orange foncé / Jaune ambre */
    text-transform: uppercase;
    font-weight: bold;
    margin-bottom: 15px;
}

.modal-body { overflow-y: auto; padding-right: 15px; margin-top: 15px; }

/* scrollbar avec dégradé bleu turquoise et jaune */
.modal-body::-webkit-scrollbar { width: 10px; }
.modal-body::-webkit-scrollbar-thumb { 
    background: linear-gradient(180deg, #00ced1 0%, #ffdb58 100%); 
    border-radius: 10px; 
}
.modal-body::-webkit-scrollbar-track { background: #f1f1f1; }

.close { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; position: absolute; right: 20px; top: 10px; }
.close:hover { color: #ff0000; }

/* fond de service avec dégradé bleu turquoise et jaune */
.service-note { 
    background: linear-gradient(135deg, #00ced1, #ffdb58); 
    color: black;
    padding: 15px; 
    border-radius: 8px;
    margin-top: 15px; 
}
        <div id="splash-screen" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #ffffff; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center;">
    <img src="/lescayesdropshipping.png" alt="Logo" style="width: 120px; margin-bottom: 20px;">
    <div style="width: 40px; height: 40px; border: 4px solid var(--kaki); border-top: 4px solid var(--bleu-marin); border-radius: 50%; animation: spin 1s linear infinite;"></div>
</div>

<style>
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    body {
    overscroll-behavior-y: contain; /* Empêche le tirer-pour-rafraîchir */
}
    </style>
</head>
<body>

    <header id="main-header">
        <div class="header-content">
            
<link rel="manifest" href='data:application/json,{"name":"Les Cayes Dropshipping","short_name":"LCD","start_url":".","display":"standalone","background_color":"#ffffff","theme_color":"#000000","icons":[{"src":"lescayesdropshipping.png","sizes":"192x192","type":"image/png"}]}' />
            
            <div id="location-header">
                <span class="material-icons location-icon">location_on</span>
                <span id="address-info">Les Cayes Dropshipping, haïti-sud</span> 
                <span class="material-icons dropdown-icon">arrow_drop_down</span>
            </div>

            <div class="announcement-bar">
    <div class="scrolling-text">
        Chè kliyan, nou ap fè mizajou nan sèvis lan pou pèmèt livrezon yo fèt pi rapid, ak plizyè lòt chanjman pou kontinye fasilite nou nan aktivite n. Mitan Fevriye, nou espere tout bagay ap retabli.
    </div>
</div>

<div id="info-livrezon-container">
    <div class="info-step">
        <p class="info-title">1. Jou anbakman :</p>
        <div class="info-detail">Chak Lendi oswa Madi</div>
        <p class="info-sub">Ekri nou pou nou ka konsolide (regwoupe) koli w yo pou ou avan nou voye yo.</p>
    </div>

    <div class="info-step no-border">
        <p class="info-title">2. Disponiblite koli :</p>
        <div class="info-detail">8 Fevriye 2026 (SDV)</div>
        <p class="info-sub">Dat previzib pou koli disponib nan adrès nou nan Sud.</p>
    </div>
</div>


    </header>

    <section id="banner-carousel">
        <div class="carousel-container">
            
            <div class="carousel-item active" style="background-image: url('pro.jpg');">
                <div class="banner-text">
                    <h1>oumenm tou w ka gen yon store</h1>
                    <p>chwazi pwodui ou vle vann yo, nap achte pou ou e livre w yo.</p>
                </div>
            </div>
            
            <div class="carousel-item" style="background-image: url('mache.jpg');">
                <div class="banner-text">
                    <h1>La rareté est terminée</h1>
                    <p>nenpòt materyèl oswa pwodui w paka jwenn sou mache a.</p>
                </div>
            </div>
<div class="carousel-item" style="background-image: url('rechajkatwise.jpg');">
    <div class="banner-text">
        <h1>Achte poukont ou</h1>
        <p>Kreye yon kat ak nou e rechaje l ak yon ajan Les Cayes Dropsh.</p>
    </div>
</div>
            <div class="carousel-item" style="background-image: url('kontr.png');">
                <div class="banner-text">
                    <h1>achte zouti modèn pou travay</h1>
                    <p>pou devni pi pèfòman nan metye w lan.</p>
                </div>
            </div>
        </div>
    </section>
        
<section class="choix-profil">
<h2 style="color: #556B2F; text-align: center;">Ki kalite sèvis ou bezwen?</h2>

    <p>Chwazi pwofil ou pou nou ka pi byen ede w jwenn sa w ap chèche a.</p>
    
    <div class="container-boutons">
        <button class="btn-choix" onclick="openModal('modal-pro')">
            <strong>Mwen se yon pwofesyonèl</strong>
            <span>ki gen metye m ap egzèse</span>
        </button>

        <button class="btn-choix" onclick="openModal('modal-entrepreneur')">
            <strong>Mwen se yon antreprenè</strong>
            <span>kap chèche yon sektè pou m envesti pou m vann</span>
        </button>
    </div>
</section>

<div id="modal-pro" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('modal-pro')">&times;</span>
        <h3 class="modal-title">SE ZOUTI KI FÈ KALITE TRAVAY.</h3>
        <div class="modal-body">
            <p>Nenpòt metye w ap egzèse (serigrafi, chapant, atis, enfòmatisyen...), se kalite materyèl ou ki detèmine vitès ak presizyon travay ou. Pa kite manke zouti anpeche w avanse.</p>
            <h4>Kisa pou w fè ?</h4>
            <ul>
                <ul class="custom-list"> <li>Ale sou platfòm tankou <strong>Temu</strong> oswa <strong>Amazon</strong>.</li>
                <ul class="custom-list"> <li> Chèche zouti ki nesesè pou metye w la.</li>
                <ul class="custom-list"> <li> Voye foto osinon lyen an ban nou.</li>
            </ul>
            <p class="service-note"><strong>Sèvis nou :</strong> Nou achte yo pou ou a pi bon pri, e nou livre w yo isit an Ayiti.</p>
        </div>
    </div>
</div>

<div id="modal-entrepreneur" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('modal-entrepreneur')">&times;</span>
        <h3 class="modal-title">FÈ YON TI BIZNIS PÈSÒN MOUN POKO FÈ.</h3>
        <div class="modal-body">
            <p><strong>Opòtinite :</strong> Gen anpil bagay moun bezwen men yo paka jwenn sou mache bòlakay ou. Si w idantifye kisa ki manke (pòch telefòn Tecno, akseswa kosmetoloji, pyès alamòd pou moto), se opòtinite pou w fè kòb.</p>
            <h4>Kòman pou w kòmanse ?</h4>
            <ul>
                <ul class="custom-list"> <li> Analize sa ki manke nan zòn ou an oswa nan sektè w gen kontak.</li>
                <ul class="custom-list"> <li> Chèche atik lan sou <strong>Temu</strong> oswa <strong>Shein</strong>.</li>
            </ul>
            <p class="service-note"><strong>Sèvis nou :</strong> Nou jere tout pwosesis acha a ak anbakman an. Ou peye frè ekspedisyon yo, nou delivre machandiz la, epi ou revann li ak yon bèl maj benefis.</p>
        </div>
    </div>
</div>

    <main id="main-content">
<h2 class="section-title"> 
    Pwodui nou gen dispo
    <a href="deal.html" class="scroll-indicator arrow-circle" aria-label="Voir plus de produits">
        <span class="material-icons">arrow_forward</span>
    </a>
</h2>

        
<div id="deal-products">
    <a href="deal.html#P001" class="product-card-link">
        <div class="product-card">
            <img src="Pwo.jpg" alt="Pwoteksyon zorèy timoun">
            <div class="product-info">
                <p class="price" style="font-size: 0.9em; height: 40px; overflow: hidden;">Pwoteksyon zorèy timoun</p>
                <p class="stock">Pri: 750 HTG</p>
            </div>
            <button class="btn-ajouter">
                <span class="material-icons">shopping_cart</span>
                Add to cart
            </button>
        </div>
    </a>
    
    <a href="deal.html#P002" class="product-card-link">
        <div class="product-card">
            <img src="Vès.jpg" alt="Kostim 2 pyès">
            <div class="product-info">
                <p class="price" style="font-size: 0.9em; height: 40px; overflow: hidden;">Kostim 2 pyès pou Citizen</p>
                <p class="stock">Pri: 8 000 HTG</p>
            </div>
            <button class="btn-ajouter">
                <span class="material-icons">shopping_cart</span>
                Add to cart
            </button>
        </div>
    </a>
    
    <a href="deal.html#P003" class="product-card-link">
        <div class="product-card">
            <img src="tecno2.jpg" alt="Pòch telefòn Tecno">
            <div class="product-info">
                <p class="price" style="font-size: 0.9em; height: 40px; overflow: hidden;">Pòch telefòn Tecno</p>
                <p class="stock">Pri: 1 000 HTG</p>
            </div>
            <button class="btn-ajouter">
                <span class="material-icons">shopping_cart</span>
                Add to cart
            </button>
        </div>
    </a>
</div>


        <h2 class="section-title" style="margin-top: 30px;">Sèvis dropshipping nou an</h2>
        <p>Les Cayes Dropshipping se yon platfòm e-commerce ki rann acha sou entènèt pi senp e pi sekirize.
<strong>Nou se premye chwa tout antreprenè</strong> ki bezwen achte e resevwa atik osinon materyèl sot aletranje.</p>
<div id="custom-install-banner" style="display:none; position:fixed; top:0; left:0; width:100%; background: #ffffff; padding: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); z-index: 10001; align-items: center; justify-content: space-between;">
    <div style="display:flex; align-items:center; gap:10px;">
        <img src="/lescayesdropshipping.jpg" style="width:40px; border-radius:5px;">

</main>

    <footer id="main-footer">
        <a href="index.html" class="nav-item active">
            <span class="material-icons">home</span>
            <p>Akèy</p>
        </a>
        <a href="decouvrir.html" class="nav-item">
            <span class="material-icons">info</span>
            <p>Règ</p>
        </a>
        <a href="transaction.html" class="nav-item">
            <span class="material-icons">list_alt</span>
            <p>Tranzaksyon</p>
        </a>
        <a href="deal.html" class="nav-item">
            <span class="material-icons">flash_on</span>
            <span id="deal-badge" class="cart-badge-nav">0</span> <p>Deal</p>
        </a>
        <a href="moncompte.html" class="nav-item">
            <span class="material-icons">person</span >
            <p>Kont mwen</p>
        </a>
        
    </footer>
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
    import { getMessaging, getToken, onMessage } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-messaging.js";

    // 1. CONFIGURATION FIREBASE
    const firebaseConfig = {
        apiKey: "AIzaSyClITNBRZPS7uCGFtbCvcW3CE-KH3VHOyI",
        authDomain: "les-cayes-dropshipping.firebaseapp.com",
        projectId: "les-cayes-dropshipping",
        storageBucket: "les-cayes-dropshipping.firebasestorage.app",
        messagingSenderId: "32618386616",
        appId: "1:32618386616:web:ab8641da3659263fe0904d",
        measurementId: "G-PNG051JBNN"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const messaging = getMessaging(app);

    // 2. SISTÈM SON AK MESAJ (LCD MOD)
    const MESSAGE_KEY = 'lcd_user_messages';
    const notifSound = new Audio('notification.mp3');

    // NOUVO: Debloke son an depi premye klik sou paj akey la
    document.addEventListener('click', () => {
        notifSound.play().then(() => {
            notifSound.pause();
            notifSound.currentTime = 0;
        }).catch(() => {});
    }, { once: true });

    // Fonksyon pou sove mesaj la (menm jan ak moncompte.html)
    function saveMessage(title, body) {
        let messages = JSON.parse(localStorage.getItem(MESSAGE_KEY)) || [];
        
        // Evite kopi
        const isDuplicate = messages.some(m => m.title === title && m.body === body && (Date.now() - m.id) < 5000);
        if (isDuplicate) return;

        messages.unshift({
            id: Date.now(),
            title: title,
            body: body,
            time: new Date().toLocaleString('ht-HT'),
            read: false
        });

        if (messages.length > 10) { messages = messages.slice(0, 10); }
        localStorage.setItem(MESSAGE_KEY, JSON.stringify(messages));
        updateNotifBadges(); // Rafrechi badge yo
    }

    // 3. FONKSYON UTILITAIRES
    const loadProfile = () => {
        try { return JSON.parse(localStorage.getItem('user_profile_data')) || {}; }
        catch (e) { return {}; }
    };

    const loadCart = () => {
        try { return JSON.parse(localStorage.getItem('lescayes_cart')) || []; }
        catch (e) { return []; }
    };

    // 4. SYSTÈME DE NOTIFICATIONS
    async function initNotifications() {
        const permission = await Notification.requestPermission();
        if (permission === "granted") {
            try {
                await getToken(messaging, { 
                    vapidKey: 'BP9kFGPwxqYaXOC-Ip3AY6L2eBMs0og181TRWEL03ROFvVf-0Onw3QibLba06Q5dZnjlQh7381JplG838ygul70' 
                });
            } catch (err) { console.log("Erreur token:", err); }
        }
    }

    onMessage(messaging, (payload) => {
        const title = payload.notification.title;
        const body = payload.notification.body;

        // Jwe son an
        notifSound.play().catch(err => console.log("Son bloke"));

        // SOVE MESAJ LA NAN MEMWA
        saveMessage(title, body);

        // Montre notifikasyon lokal la
        const notification = new Notification(title, {
            body: body,
            icon: "/lescayesdropshipping.jpg",
            data: { url: "moncompte.html?tab=mesaj" }
        });
        
        notification.onclick = (event) => {
            event.preventDefault();
            window.location.href = "moncompte.html?tab=mesaj";
        };
    });

    // 5. INITIALISATION UI
    document.addEventListener('DOMContentLoaded', () => {
        setTimeout(() => {
            const splash = document.getElementById('splash-screen');
            if(splash) splash.style.display = 'none';
        }, 1500);

        initNotifications();
        updateNotifBadges(); // Tcheke si gen mesaj ki pako li pou footer a

        // Carousel ak Swipe kòd ou a...
        initCarousel();
        updateBadgeUI(); // Badge panier a
        updateLocationHeader();
    });

    // Mizajou Badge Cloche (si li la) ak Footer
    function updateNotifBadges() {
        const messages = JSON.parse(localStorage.getItem(MESSAGE_KEY)) || [];
        const unreadCount = messages.filter(m => !m.read).length;
        
        const footerBadge = document.getElementById('footer-badge');
        if (footerBadge) {
            if (unreadCount > 0) {
                footerBadge.style.display = 'block';
                footerBadge.textContent = unreadCount;
            } else {
                footerBadge.style.display = 'none';
            }
        }
    }

    // Rès fonksyon ou yo (initCarousel, updateBadgeUI, elatriye...)
    function updateBadgeUI() {
        const badge = document.getElementById('deal-badge');
        const count = loadCart().length;
        if(badge) {
            badge.textContent = count;
            badge.style.display = count > 0 ? 'block' : 'none';
        }
    }

    // ... (Kenbe fonksyon openModal, closeModal ak Service Worker ou yo) ...
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/firebase-messaging-sw.js')
            .then(reg => console.log('SW anrejistre'))
            .catch(err => console.log('Erreur SW:', err));
    }
</script>
</body>
</html>
